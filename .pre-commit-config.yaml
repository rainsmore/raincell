repos:
  - repo: local
    hooks:
      - id: nbdev-clean
        name: Prepare notebooks for commit
        entry: |
          bash -c '
            git diff --cached --name-only --diff-filter=AM | grep "\.ipynb$" | while IFS= read -r file; do
              echo "Cleaning: $file"
              nbdev_clean --fname "$file" || echo "Failed to clean $file"
              git add "$file" || echo "Failed to add $file"
            done
          '
        language: system
        pass_filenames: false
        files: \.ipynb$